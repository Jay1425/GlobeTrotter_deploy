<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reset Password â€¢ GlobeTrotter</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <meta name="color-scheme" content="light only" />
  <style>
    * {
      font-family: 'Inter', sans-serif;
    }
    
    :root {
      --bg-neutral: #F0F4F8;
      --text-deep: #1A2B3D;
      --pale-card: #B8D4E3;
      --hover-forest: #2563EB;
      --text-secondary: #64748B;
      --cta: #3B82F6;
      --cta-hover: #2563EB;
      --cool-contrast: #8B5CF6;
      --error: #DC2626;
      --success: #10b981;
    }

    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
    }

    /* Luxury animated background */
    .bg-lux-animated {
      background: linear-gradient(120deg, var(--bg-neutral), var(--pale-card), var(--bg-neutral));
      background-size: 200% 200%;
      animation: luxGradient 20s ease-in-out infinite;
    }
    @keyframes luxGradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Floating background elements */
    .blob {
      filter: blur(22px);
      opacity: .28;
      animation: float 30s ease-in-out infinite;
      will-change: transform;
    }
    @keyframes float {
      0%, 100% { transform: translate(0, 0) scale(1); }
      25% { transform: translate(18px, -22px) scale(1.03); }
      50% { transform: translate(-20px, 14px) scale(.97); }
      75% { transform: translate(12px, 18px) scale(1.01); }
    }

    /* Button styles */
    .btn-stable {
      min-width: 160px;
      height: 48px;
      box-sizing: border-box;
      pointer-events: auto;
    }
    
    .btn-stable * {
      pointer-events: none;
    }

    /* Field animations */
    .field {
      opacity: 0;
      transform: translateY(20px);
    }
    .field.animate {
      opacity: 1;
      transform: translateY(0);
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .field-stagger:nth-child(1) { animation-delay: 0.1s; }
    .field-stagger:nth-child(2) { animation-delay: 0.2s; }
    .field-stagger:nth-child(3) { animation-delay: 0.3s; }
    .field-stagger:nth-child(4) { animation-delay: 0.4s; }
    .field-stagger:nth-child(5) { animation-delay: 0.5s; }

    /* Password eye animation */
    .eye {
      transition: all 0.3s ease;
    }
    .eye:hover {
      transform: scale(1.1);
    }
  </style>
</head>

<body class="bg-lux-animated min-h-screen relative overflow-x-hidden">
  <!-- Floating background elements -->
  <div class="blob w-72 h-72 bg-gradient-to-br from-blue-300 to-purple-400 rounded-full absolute -top-20 -left-20 z-0"></div>
  <div class="blob w-96 h-96 bg-gradient-to-br from-purple-300 to-pink-400 rounded-full absolute top-1/3 -right-32 z-0" style="animation-delay: -10s;"></div>
  <div class="blob w-80 h-80 bg-gradient-to-br from-green-300 to-blue-400 rounded-full absolute bottom-0 left-1/4 z-0" style="animation-delay: -20s;"></div>

  <div class="relative z-10 min-h-screen flex items-center justify-center p-4">
    <section class="w-full max-w-md">
      <!-- Main card -->
      <div class="bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/30 p-8 transition-all duration-500 hover:shadow-3xl">
        <!-- Header -->
        <div class="text-center mb-8">
          <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-[var(--cta)] to-[var(--cta-hover)] rounded-full mb-4 shadow-lg">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
            </svg>
          </div>
          <h1 id="rp_title" class="text-3xl font-bold text-[var(--text-deep)] mb-2">Reset Password</h1>
          <p class="text-[var(--text-secondary)]">Enter your new password below</p>
        </div>

        <!-- Reset Password Form -->
        <form id="resetPasswordForm" role="form" aria-labelledby="rp_title" class="space-y-6" autocomplete="on" method="post" action="{{ url_for('reset_password', token=token) }}">
          <div class="space-y-5">
            <!-- New Password Field -->
            <div class="field field-stagger">
              <div class="relative">
                <input id="rp_password" name="password" type="password" required placeholder=" " autocomplete="new-password"
                       class="peer w-full rounded-xl border-2 border-gray-200 bg-white/90 px-4 py-4 pl-12 pr-12 text-[var(--text-deep)] placeholder-transparent shadow-sm transition-all duration-200 focus:border-[var(--cta)] focus:ring-4 focus:ring-[var(--cta)]/20 focus:outline-none hover:border-gray-300" 
                       aria-required="true" aria-label="New Password" minlength="6" />
                <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 transition-colors duration-200 peer-focus:text-[var(--cta)]">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                  </svg>
                </div>
                <button type="button" class="eye absolute inset-y-0 right-0 my-auto mr-3 grid place-items-center rounded-lg p-2 text-gray-400 hover:text-[var(--cta)] focus:outline-none focus:ring-2 focus:ring-[var(--cta)]/20 transition-colors" 
                        aria-label="Toggle password visibility" aria-pressed="false" data-target="rp_password">
                  <svg class="h-5 w-5 eye-open" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8Z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                  <svg class="h-5 w-5 eye-closed hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path>
                    <path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 11 8 11 8a13.16 13.16 0 0 1-1.67 2.68"></path>
                    <path d="M6.61 6.61A13.526 13.526 0 0 0 1 12s4 8 11 8a9.74 9.74 0 0 0 5.39-1.61"></path>
                    <line x1="2" y1="2" x2="22" y2="22"></line>
                  </svg>
                </button>
                <label for="rp_password" class="absolute left-14 top-4 text-gray-500 text-sm transition-all duration-200 origin-left peer-placeholder-shown:left-14 peer-placeholder-shown:top-4 peer-placeholder-shown:scale-100 peer-focus:left-14 peer-focus:top-1 peer-focus:scale-75 peer-focus:text-[var(--cta)] peer-valid:left-14 peer-valid:top-1 peer-valid:scale-75 peer-valid:text-[var(--cta)]">New Password</label>
              </div>
            </div>

            <!-- Confirm Password Field -->
            <div class="field field-stagger">
              <div class="relative">
                <input id="rp_confirm" name="confirm_password" type="password" required placeholder=" " autocomplete="new-password"
                       class="peer w-full rounded-xl border-2 border-gray-200 bg-white/90 px-4 py-4 pl-12 pr-12 text-[var(--text-deep)] placeholder-transparent shadow-sm transition-all duration-200 focus:border-[var(--cta)] focus:ring-4 focus:ring-[var(--cta)]/20 focus:outline-none hover:border-gray-300" 
                       aria-required="true" aria-label="Confirm Password" minlength="6" />
                <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 transition-colors duration-200 peer-focus:text-[var(--cta)]">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                  </svg>
                </div>
                <button type="button" class="eye absolute inset-y-0 right-0 my-auto mr-3 grid place-items-center rounded-lg p-2 text-gray-400 hover:text-[var(--cta)] focus:outline-none focus:ring-2 focus:ring-[var(--cta)]/20 transition-colors" 
                        aria-label="Toggle confirm password visibility" aria-pressed="false" data-target="rp_confirm">
                  <svg class="h-5 w-5 eye-open" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8Z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                  <svg class="h-5 w-5 eye-closed hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path>
                    <path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 11 8 11 8a13.16 13.16 0 0 1-1.67 2.68"></path>
                    <path d="M6.61 6.61A13.526 13.526 0 0 0 1 12s4 8 11 8a9.74 9.74 0 0 0 5.39-1.61"></path>
                    <line x1="2" y1="2" x2="22" y2="22"></line>
                  </svg>
                </button>
                <label for="rp_confirm" class="absolute left-14 top-4 text-gray-500 text-sm transition-all duration-200 origin-left peer-placeholder-shown:left-14 peer-placeholder-shown:top-4 peer-placeholder-shown:scale-100 peer-focus:left-14 peer-focus:top-1 peer-focus:scale-75 peer-focus:text-[var(--cta)] peer-valid:left-14 peer-valid:top-1 peer-valid:scale-75 peer-valid:text-[var(--cta)]">Confirm Password</label>
              </div>
            </div>
          </div>

          <!-- Submit button -->
          <div class="field-stagger">
            <button type="submit" 
                    class="btn-stable w-full inline-flex items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-[var(--cta)] to-[var(--cta-hover)] px-6 py-4 font-semibold text-white shadow-lg shadow-blue-600/25 transition-all duration-200 hover:scale-[1.02] hover:shadow-xl hover:shadow-blue-600/30 focus:outline-none focus:ring-4 focus:ring-blue-500/20 active:scale-[0.98]" 
                    aria-label="Reset Password">
              <span>Reset Password</span>
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </button>
          </div>

          {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
              <div class="mt-4 space-y-2">
                {% for category, message in messages %}
                  <div class="text-sm px-3 py-2 rounded-lg {{ 'text-green-700 bg-green-50 border border-green-200' if category=='success' else 'text-red-700 bg-red-50 border border-red-200' }}">{{ message }}</div>
                {% endfor %}
              </div>
            {% endif %}
          {% endwith %}

          <!-- Navigation links -->
          <div class="field-stagger text-center space-y-3">
            <p class="text-sm text-[var(--text-secondary)]">
              Remember your password?
              <a href="{{ url_for('login') }}" 
                 class="font-semibold text-[var(--cta)] hover:text-[var(--cta-hover)] hover:underline focus:outline-none focus:ring-2 focus:ring-[var(--cta)]/20 rounded ml-1 transition-colors">
                Sign in
              </a>
            </p>
            
            <!-- Security info -->
            <div class="flex items-center justify-center gap-4 mt-4 pt-4 border-t border-gray-200">
              <div class="flex items-center gap-2 text-xs text-gray-500">
                <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span>Secure reset</span>
              </div>
              <div class="flex items-center gap-2 text-xs text-gray-500">
                <svg class="w-4 h-4 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                </svg>
                <span>Privacy protected</span>
              </div>
            </div>
          </div>
        </form>
      </div>
    </section>
  </div>

  <script>
    // Enhanced form animations and interactions
    document.addEventListener('DOMContentLoaded', function() {
      // Animate fields on load
      setTimeout(() => {
        const fields = document.querySelectorAll('.field');
        fields.forEach((field, index) => {
          setTimeout(() => {
            field.classList.add('animate');
          }, index * 100);
        });
      }, 200);

      // Password visibility toggles
      const eyeButtons = document.querySelectorAll('.eye');
      eyeButtons.forEach(button => {
        button.addEventListener('click', function() {
          const targetId = this.getAttribute('data-target');
          const input = document.getElementById(targetId);
          const eyeOpen = this.querySelector('.eye-open');
          const eyeClosed = this.querySelector('.eye-closed');
          
          const isPasswordVisible = input.type === 'text';
          input.type = isPasswordVisible ? 'password' : 'text';
          
          eyeOpen.classList.toggle('hidden', !isPasswordVisible);
          eyeClosed.classList.toggle('hidden', isPasswordVisible);
          
          this.setAttribute('aria-pressed', !isPasswordVisible);
        });
      });

      // Password confirmation validation
      const password = document.getElementById('rp_password');
      const confirmPassword = document.getElementById('rp_confirm');
      const form = document.getElementById('resetPasswordForm');

      function validatePasswords() {
        if (password.value && confirmPassword.value) {
          if (password.value !== confirmPassword.value) {
            confirmPassword.setCustomValidity('Passwords do not match');
          } else {
            confirmPassword.setCustomValidity('');
          }
        }
      }

      password.addEventListener('input', validatePasswords);
      confirmPassword.addEventListener('input', validatePasswords);

      // Form submission validation
      form.addEventListener('submit', function(e) {
        if (password.value !== confirmPassword.value) {
          e.preventDefault();
          alert('Passwords do not match. Please check your passwords and try again.');
          confirmPassword.focus();
        }
      });

      // Button interaction feedback
      const submitButton = form.querySelector('button[type="submit"]');
      
      function lockButtonDimensions() {
        if (!submitButton.style.width) {
          const rect = submitButton.getBoundingClientRect();
          submitButton.style.width = rect.width + 'px';
          submitButton.style.height = rect.height + 'px';
        }
      }

      submitButton.addEventListener('mousedown', lockButtonDimensions);
      submitButton.addEventListener('touchstart', lockButtonDimensions);
    });
  </script>
</body>
</html>
